<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>deviate from the norm - Regression Modeling in Practice: Describing Data</title>
    <meta name="description" content="">
    <meta name="author" content="Ernő Gólya">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://ernogolya.github.io/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="https://ernogolya.github.io/theme/bootstrap.min.css" rel="stylesheet">
    <link href="https://ernogolya.github.io/theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="https://ernogolya.github.io/theme/local.css" rel="stylesheet">
    <link href="https://ernogolya.github.io/theme/pygments.css" rel="stylesheet">

    <!-- So Firefox can bookmark->"abo this site" -->

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="https://ernogolya.github.io">deviate from the norm</a>

        <div class="nav-collapse">
        <ul class="nav">
            
            <li><a href="https://ernogolya.github.io/pages/about/">About</a></li>
        </ul>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
    <div class='article'>
        <div class="content-title">
            <h1>Regression Modeling in Practice: Describing Data</h1>
v 07 augusztus 2016

by <a class="url fn" href="https://ernogolya.github.io/author/erno-golya.html">Ernő Gólya</a>
 


        </div>
	
        <div><p>The data set I use for the <a href="https://www.coursera.org/specializations/data-analysis">Data Analysis and Interpretation Specialization</a> courses by Wesleyan University is an excerpt of the data available at the <a href="https://www.gapminder.org">Gapminder</a> site.<br />
Gapminder is a non-profit foundation promoting sustainable global development and achievement of the United Nations Millennium Development Goals. The indicators collected here provide an insight into the social, economic and environmental development at local, national and global levels, and allow longitudinal assessment of these variables over many years.</p>
<h3>Sample</h3>
<p>My sample provides values for under-five child mortality rate (used as response variable), mean years in school for women, per capita total expenditure on health and income per person (explanatory variables, moderators) for 167 countries from 2009 and 2010. In my analyses the data is usually filtered so that only observations without missing data are shown which means, in most cases, I have data for 154 observations.
This consolidated and organized human population data is recorded for each country at an individual level. Unique identifier: country. Each row contains information about one observation (one year in one country). All variables are quantitative.</p>
<h3>Procedure</h3>
<p>Gapminder has unified many databases from several sources, including the Institute for Health Metrics and Evaluation, US Census Bureau’s International Database, United Nations Statistics Division, World Bank, universities and non-governmental organizations into a single database with a consistent format. Their purpose is to promote greater understanding and use of statistics and other information by making time series freely available and showing major global development trends by producing videos, presentations and charts. The Gapminder database includes over 600 variables, with data from 258 current and former countries and territories. All variables used here were generated by data reporting and are observational (child mortality includes estimations). The database is under active development and it is updated frequently, hence, identical analyses can sometimes produce different results.</p>
<p>The data is arranged in spreadsheet format. The data itself is available through excel files. These files include both the detailed meta-data, as well as the actual observations. There is normally one documentation for each indicator, but sometimes several indicators are described in one documentation.
I converted the excel spreadsheets containing the required indicators to csv files and then joined them into one custom data set.</p>
<div class="highlight"><pre>    <span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">&#39;csv/under5mortality.csv&#39;</span><span class="p">)</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">&#39;csv/schoolyears.csv&#39;</span><span class="p">)</span>
    <span class="n">f3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">&#39;csv/health.csv&#39;</span><span class="p">)</span>
    <span class="n">f4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">&#39;csv/gapminder.csv&#39;</span><span class="p">)</span>
    <span class="n">merged_inner</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s">&#39;country&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">f3</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s">&#39;country&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">f4</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s">&#39;country&#39;</span><span class="p">)</span>
    <span class="n">merged_inner</span><span class="p">[[</span><span class="s">&#39;country&#39;</span><span class="p">,</span><span class="s">&#39;under5mort&#39;</span><span class="p">,</span><span class="s">&#39;womenschool&#39;</span><span class="p">,</span><span class="s">&#39;healthexpend&#39;</span><span class="p">,</span><span class="s">&#39;incomeperperson&#39;</span><span class="p">]]</span>
</pre></div>


<p><em>Sample from table</em></p>
<table>
<thead>
<tr>
<th align="left">index</th>
<th>country</th>
<th>under5mort</th>
<th>womenschool</th>
<th>healthexpend</th>
<th>incomeperperson</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">0</td>
<td>Afghanistan</td>
<td>105.0</td>
<td>0.8</td>
<td>37.666786</td>
<td></td>
<td></td>
</tr>
<tr>
<td align="left">1</td>
<td>Albania</td>
<td>16.6</td>
<td>10.7</td>
<td>240.824785</td>
<td>1914.99655094922</td>
<td></td>
</tr>
<tr>
<td align="left">2</td>
<td>Algeria</td>
<td>27.4</td>
<td>7.1</td>
<td>178.245066</td>
<td>2231.99333515006</td>
<td></td>
</tr>
<tr>
<td align="left">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td></td>
</tr>
<tr>
<td align="left">165</td>
<td>Zambia</td>
<td>84.8</td>
<td>6.7</td>
<td>72.884346</td>
<td>432.226336974583</td>
<td></td>
</tr>
<tr>
<td align="left">166</td>
<td>Zimbabwe</td>
<td>95.1</td>
<td>9.0</td>
<td>NaN</td>
<td>320.771889948584</td>
<td></td>
</tr>
</tbody>
</table>
<h3>Measures</h3>
<p>Data management was applied to remove countries that have one or more variable not measured. I also set variables to numeric. If categorical data was expected, variables were grouped into categories as needed.</p>
<div class="highlight"><pre>    <span class="c"># set variables to numeric</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&quot;incomeperperson&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;incomeperperson&quot;</span><span class="p">],</span><span class="n">errors</span><span class="o">=</span><span class="s">&#39;coerce&#39;</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&quot;under5mort&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;under5mort&quot;</span><span class="p">],</span><span class="n">errors</span><span class="o">=</span><span class="s">&#39;coerce&#39;</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&quot;womenschool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;womenschool&quot;</span><span class="p">],</span><span class="n">errors</span><span class="o">=</span><span class="s">&#39;coerce&#39;</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&quot;healthexpend&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;healthexpend&quot;</span><span class="p">],</span><span class="n">errors</span><span class="o">=</span><span class="s">&#39;coerce&#39;</span><span class="p">)</span>

    <span class="c"># remove observations with NaN values in any variables of interest</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c"># Creating categories</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&quot;incomeperperson_cat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">incomeperperson</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1005</span><span class="p">,</span> <span class="mi">3975</span><span class="p">,</span> <span class="mi">12275</span><span class="p">,</span> <span class="mi">65000</span><span class="p">],</span>\
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;Low&quot;</span><span class="p">,</span> <span class="s">&quot;Lower middle&quot;</span><span class="p">,</span> <span class="s">&quot;Upper middle&quot;</span><span class="p">,</span> <span class="s">&quot;High&quot;</span> <span class="p">])</span>
    <span class="n">sub2</span><span class="p">[</span><span class="s">&quot;under5mort_cat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">sub2</span><span class="o">.</span><span class="n">under5mort</span><span class="p">,</span>\
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;0-10&quot;</span><span class="p">,</span> <span class="s">&quot;10-50&quot;</span><span class="p">,</span> <span class="s">&quot;50-100&quot;</span><span class="p">,</span> <span class="s">&quot;100-220&quot;</span><span class="p">])</span>
    <span class="n">sub2</span><span class="p">[</span><span class="s">&quot;womenschool_cat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">sub2</span><span class="o">.</span><span class="n">womenschool</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>\
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;0-4 years&quot;</span><span class="p">,</span> <span class="s">&quot;4-8 years&quot;</span><span class="p">,</span> <span class="s">&quot;8-12 years&quot;</span><span class="p">,</span> <span class="s">&quot;12-16 years&quot;</span><span class="p">])</span>
    <span class="n">sub2</span><span class="p">[</span><span class="s">&quot;healthexpend_cat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">sub2</span><span class="o">.</span><span class="n">healthexpend</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">9000</span><span class="p">],</span> \
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;1-100&quot;</span><span class="p">,</span> <span class="s">&quot;100-300&quot;</span><span class="p">,</span> <span class="s">&quot;300-1000&quot;</span><span class="p">,</span> <span class="s">&quot;1000-5000&quot;</span><span class="p">,</span> <span class="s">&quot;5000-9000&quot;</span> <span class="p">])</span>

    <span class="c"># median global child mortality</span>
    <span class="n">under5median</span> <span class="o">=</span> <span class="n">sub1</span><span class="p">[</span><span class="s">&#39;under5mort&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

    <span class="c"># create u5_abovemedian variable (value = 1 if under5mort &gt; under5median, othervise value = 0)</span>
    <span class="k">def</span> <span class="nf">u5_abovemedian</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s">&#39;under5mort&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">under5median</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
    <span class="n">sub2</span><span class="p">[</span><span class="s">&#39;u5_abovemedian&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">u5_abovemedian</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<p><strong><em>The under-five mortality</em></strong> dataset has been compiled from several sources, including estimations: CME info estimates, Human Mortality Database, Gapminder’s IMR series, Data extrapolated back to 1800 based on Gapminder Life Expectancy combined with model life tables, other guesstimates. This <code>response variable</code> measures the probability that a child born in a specific year will die before reaching the age of five if subject to current age-specific mortality rates. Expressed as a rate per 1,000 live births in each country. Data from 261 nations and territories covers years from 1800 through 2015 from which I chose year 2010. Binned into 4 categories (0-10, 10-50, 50-100, 100-220) for frequency distribution calculations. For Chi-Square test I divided the continuos data into two categories using the median as a cutoff point: 0: <code>under5mort</code> &lt;= 19.5, 1: <code>under5mort</code> &gt; 19.5.</p>
<p><strong><em>Mean years in school</em></strong>: the average number of years of school attended by women of reproductive age, 15 to 44, including primary, secondary and tertiary education during 2009. Source organization is the Institute for Health Metrics and Evaluation. This data set containes data from 175 countries from 1970 to 2009. For some explorations it was binned into four categories: 0-4, 4-8, 8-12 and 12-16 years. Main <code>explanatory variable</code>.</p>
<p><strong><em>Income per person</em></strong> data comes with 213 observations from 2010. Sources are the World Bank Work Development Indicators. It represents the Gross Domestic Product per capita in constant 2000 US$ for the year 2010. The inflation but not the differences in the cost of living between countries has been taken into account. <code>Explanatory variable</code>, also used as <code>moderator</code> in my previous Pearson correlation test. For several analyses it was binned into four categories based on World Bank income groups (low: 1-1,005 US$, lower-middle: 1,006-3,975 US$, upper-middle: 3,976-12,275 US$, and high: &gt; 12,275 US$).</p>
<p><strong><em>Per capita total expenditure on health</em></strong> is expressed at average exchange rate for that year in US$. Current prices, reported by the World Health Organization. Data extends back to 1995, includes 259 nations and territories. For the analyses performed on this <code>explanatory variable</code>, I use data from 2010. Quantitative data, binned into 5 categories (1-100 US$, 100-300 US$, 300-1000 US$, 1000-5000 US$, 5000-9000 US$) when needed.  </p></div>
	
        <hr>

    </div>
        </div>
        
        <div class="span3">

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Site
                </li>
            
                <li><a href="https://ernogolya.github.io/archives.html">Archives</a>
                <li><a href="https://ernogolya.github.io/tags.html">Tags</a>




            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Categories
                </li>
                
                <li><a href="https://ernogolya.github.io/category/data-science.html">Data Science</a></li>
                <li><a href="https://ernogolya.github.io/category/machine-learning.html">Machine Learning</a></li>
                   
            </ul>
            </div>




            <div class="social">
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Social
                </li>
           
                <li><a href="https://hu.linkedin.com/in/ernő-gólya-44626093">Linkedin</a></li>
            </ul>
            </div>
            </div>

        </div>  
    </div>     </div> 
<footer>
<br />
<p><a href="https://ernogolya.github.io">deviate from the norm</a> &copy; Ernő Gólya 2016</p>
</footer>

</div> <!-- /container -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="https://ernogolya.github.io/theme/bootstrap-collapse.js"></script>
 
</body>
</html>